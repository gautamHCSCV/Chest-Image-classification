cuda:1
model: efficientnet
defining efficientnet
train_labels_nih file already exits
test_labels_nih file already exits
1912
568
213
total_trainable_parameters are : 17.56M
Epoch: 1/30
---------------
=> saving checkpoint
epoch:[1/30], TrainAcc:0.760, TrainLoss:0.709, ValAcc:0.774, ValLoss:0.641
Epoch: 2/30
---------------
=> saving checkpoint
epoch:[2/30], TrainAcc:0.779, TrainLoss:0.623, ValAcc:0.776, ValLoss:0.631
Epoch: 3/30
---------------
=> saving checkpoint
epoch:[3/30], TrainAcc:0.797, TrainLoss:0.562, ValAcc:0.781, ValLoss:0.635
Epoch: 4/30
---------------
epoch:[4/30], TrainAcc:0.831, TrainLoss:0.466, ValAcc:0.767, ValLoss:0.711
Epoch: 5/30
---------------
epoch:[5/30], TrainAcc:0.875, TrainLoss:0.344, ValAcc:0.762, ValLoss:0.827
Epoch: 6/30
---------------
epoch:[6/30], TrainAcc:0.916, TrainLoss:0.232, ValAcc:0.755, ValLoss:1.029
Epoch: 7/30
---------------
epoch:[7/30], TrainAcc:0.939, TrainLoss:0.166, ValAcc:0.752, ValLoss:1.148
Epoch: 8/30
---------------
epoch:[8/30], TrainAcc:0.952, TrainLoss:0.131, ValAcc:0.748, ValLoss:1.281
Epoch: 9/30
---------------
epoch:[9/30], TrainAcc:0.962, TrainLoss:0.107, ValAcc:0.751, ValLoss:1.325
Epoch: 10/30
---------------
epoch:[10/30], TrainAcc:0.966, TrainLoss:0.095, ValAcc:0.743, ValLoss:1.417
Epoch: 11/30
---------------
epoch:[11/30], TrainAcc:0.969, TrainLoss:0.088, ValAcc:0.740, ValLoss:1.383
Epoch: 12/30
---------------
epoch:[12/30], TrainAcc:0.973, TrainLoss:0.078, ValAcc:0.755, ValLoss:1.507
Epoch: 13/30
---------------
epoch:[13/30], TrainAcc:0.975, TrainLoss:0.072, ValAcc:0.748, ValLoss:1.477
Epoch: 14/30
---------------
epoch:[14/30], TrainAcc:0.976, TrainLoss:0.067, ValAcc:0.751, ValLoss:1.441
Epoch: 15/30
---------------
epoch:[15/30], TrainAcc:0.978, TrainLoss:0.063, ValAcc:0.744, ValLoss:1.588
Epoch: 16/30
---------------
epoch:[16/30], TrainAcc:0.979, TrainLoss:0.061, ValAcc:0.759, ValLoss:1.673
Epoch: 17/30
---------------
epoch:[17/30], TrainAcc:0.981, TrainLoss:0.055, ValAcc:0.760, ValLoss:1.602
Epoch: 18/30
---------------
epoch:[18/30], TrainAcc:0.982, TrainLoss:0.053, ValAcc:0.764, ValLoss:1.721
Epoch: 19/30
---------------
epoch:[19/30], TrainAcc:0.983, TrainLoss:0.050, ValAcc:0.762, ValLoss:1.803
Epoch: 20/30
---------------
epoch:[20/30], TrainAcc:0.983, TrainLoss:0.049, ValAcc:0.761, ValLoss:1.655
Epoch: 21/30
---------------
epoch:[21/30], TrainAcc:0.985, TrainLoss:0.044, ValAcc:0.765, ValLoss:1.691
Epoch: 22/30
---------------
epoch:[22/30], TrainAcc:0.985, TrainLoss:0.045, ValAcc:0.756, ValLoss:1.764
Epoch: 23/30
---------------
epoch:[23/30], TrainAcc:0.985, TrainLoss:0.042, ValAcc:0.757, ValLoss:1.729
Epoch: 24/30
---------------
epoch:[24/30], TrainAcc:0.986, TrainLoss:0.041, ValAcc:0.762, ValLoss:1.978
Epoch: 25/30
---------------
epoch:[25/30], TrainAcc:0.986, TrainLoss:0.041, ValAcc:0.747, ValLoss:1.732
Epoch: 26/30
---------------
epoch:[26/30], TrainAcc:0.987, TrainLoss:0.039, ValAcc:0.756, ValLoss:1.763
Epoch: 27/30
---------------
epoch:[27/30], TrainAcc:0.988, TrainLoss:0.035, ValAcc:0.763, ValLoss:2.033
Epoch: 28/30
---------------
epoch:[28/30], TrainAcc:0.987, TrainLoss:0.037, ValAcc:0.748, ValLoss:1.808
Epoch: 29/30
---------------
epoch:[29/30], TrainAcc:0.988, TrainLoss:0.035, ValAcc:0.756, ValLoss:1.900
Epoch: 30/30
---------------
epoch:[30/30], TrainAcc:0.989, TrainLoss:0.033, ValAcc:0.756, ValLoss:1.955
done time 11.924 hours
correct are 0.561
              precision    recall  f1-score   support

           0       0.67      0.78      0.72      9861
           1       0.29      0.24      0.26      2434
           2       0.34      0.19      0.24       759
           3       0.18      0.06      0.09      1353
           4       0.44      0.44      0.44      3745

    accuracy                           0.56     18152
   macro avg       0.38      0.34      0.35     18152
weighted avg       0.52      0.56      0.53     18152

class-wise
[0.67013437 0.28669612 0.34047619 0.18243243 0.44052745]
[0.78389616 0.23993426 0.1884058  0.05986696 0.43711615]
[0.72256497 0.2612391  0.24257846 0.09015025 0.43881517]
avg-out
0.3840533134342941
0.34184386708841147
0.35106958815566247
